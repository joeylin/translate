<!DOCTYPE html>
<html lang="en">
    <head>
        <meta http-equiv="content-type" content="text/html; charset=UTF-8"> 
        <title>Translate</title>
        <meta name="generator" content="translate" />
        <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

        <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon"/>
        <!-- bootstrap 3.0.2 -->
        <link href="/public/css/bootstrap.min.css" rel="stylesheet" type="text/css" />
        <!-- font Awesome -->
        <link href="/public/css/font-awesome.min.css" rel="stylesheet" type="text/css" />
        <!-- Theme style -->
        <link href="/public/css/AdminLTE.css" rel="stylesheet" type="text/css" />

        <!--[if lt IE 9]>
          <script src="//html5shim.googlecode.com/svn/trunk/html5.js"></script>
        <![endif]-->

        <!-- CSS code from translate.com editor -->
        
        <style type="text/css">
          body {
            background: #fff;
          }
          .navbar {
            border: none;
          }
          .navbar .navbar-header {
            height: 86px;
            background-color: #fff;
            width: 252px;
          }
          .navbar {
            background-color: #101010;
          }
          .navbar .navbar-header a {
            line-height: 56px;
            font-size: 32px;
            color: rgb(51, 51, 51);
            width: 100%;
            text-align: center;
          }
          .subTile {
            color: #f9f9f9;
            font-size: 18px;
            line-height: 86px;
            padding-left: 15px;
          }
          .form-inline {
            line-height: 84px;
          }
          .signUpContainer {
            margin-top: 60px;
            margin-bottom: 60px;
          }
          .nav-tabs-custom {
            box-shadow: none;
          }
          .signupTab .nav-tabs>li>a {
            border: 0;
            font-size: 18px;
          }
          .signupTab > .nav-tabs > li {
            border-top: 0;
            border-bottom: 3px solid transparent;
          }
          .signupTab > .nav-tabs > li.active {
            border-bottom-color: #3c8dbc;
          }
          .signupTab > .nav-tabs {
            border-bottom-color: transparent;
          }
          .signupTab .nav-tabs>li.active>a:hover {
            border: 0;
          }
          .signupTab .tab-content {
            margin-top: 30px;
          }
          .signupTab .tab-content label {
            line-height: 37px;
            width: 100%;
            text-align: right;
            font-weight: 400;
          }
          .signupTab .tab-pane form > div {
            margin-bottom: 10px;
          }
          .signupTab label.error {
            position: absolute;
            top: -27px;
            left: 28px;
            color: red;
            text-align: left; 
          }
          .signUpContainer .promoteContainer {
            padding-left: 30px;
            height: 402px;
            overflow: hidden;
          }
          .signupFooter {
            position: relative;
          }
          .signupFooter label.error {
            line-height: 18px;
            text-align: right;
          }
          .pageFooter {
            height: 86px;
          }
          .pageFooter p {
            width: 100%;
          }
          /*reset style*/
          .form-group .radio {
            margin-bottom: 0;
            margin-top: 0;
          }
          .form-inline input.error:focus {
            border-color: red!important;
          }
        </style>
        
    </head>
    
    <!-- HTML code from Bootply.com editor -->   
    <body>   
        <nav class="navbar" role="navigation">
          <div class="container">
            <div class="navbar-header">
              <a class="navbar-brand" href="#">Forin</a>
            </div>
            <div class="navbar-collapse collapse">
              <ul class="nav navbar-nav navbar-right">
                <li>
                  <form class="form-inline" role="form" id="formLogin">
                    <div class="form-group">
                      <input type="email" class="form-control" id="loginEmail" placeholder="Enter email">
                    </div>
                    <div class="form-group">
                      <input type="password" class="form-control" id="loginPassword" placeholder="Password">
                    </div>
                    <div class="form-group">
                      <button type="button" id="btnLogin" class="btn btn-primary">Login</button>
                    </div>
                  </form>
                </li>
              </ul>
              <ul class="nav navbar-nav navbar-left">
                <li class="subTile">Make Yourself Valuable</li>
              </ul>
            </div>
          </div>
        </nav>
        <div class="container signUpContainer">
          <div class="row">
            <div class="col-md-4">
              <div class="nav-tabs-custom signupTab">
                  <ul class="nav nav-tabs">
                      <li class="active"><a href="#tab_1" data-toggle="tab">User</a></li>
                      <li class=""><a href="#tab_2" data-toggle="tab">Company</a></li>
                  </ul>
                  <div class="tab-content">
                      <div class="tab-pane active" id="tab_1">
                          <form action="" method="post" id="formUser">
                            <div class="row">
                              <div class="col-xs-3">
                                <label>Email</label>
                              </div>
                              <div class="col-xs-9">
                                <input class="form-control" name="email" id="inputEmail" type="email" placeholder="Email" required="" required="">
                              </div>
                            </div>
                            <div class="row">
                              <div class="col-xs-3">
                                <label>RealName</label>
                              </div>
                              <div class="col-xs-9">
                                <input class="form-control" name="name" id="inputName" type="text" placeholder="Username" pattern="^[a-z,A-Z,0-9,_]{6,15}$" data-valid-min="6" required="">
                              </div>
                            </div>
                            <div class="row">
                              <div class="col-xs-3">
                                <label>Password</label>
                              </div>
                              <div class="col-xs-9">
                                <input class="form-control" name="password" id="inputPassword" type="password" placeholder="Password" required="">
                              </div>
                            </div>
                            <div class="row">
                              <div class="col-xs-3">
                                <label>Sex</label>
                              </div>
                              <div class="col-xs-9">
                                <div class="form-group clearfix"> 
                                    <div class="radio pull-left" style="margin-right: 10px;">
                                        <label>
                                            <input type="radio" class="inputRadio" name="userSex" id="userSex" value="Male" checked="">
                                            Male
                                        </label>
                                    </div>
                                    <div class="radio pull-left">
                                        <label>
                                            <input type="radio" class="inputRadio" name="userSex" value="Female">
                                            Female
                                        </label>
                                    </div>               
                                </div>
                              </div>
                            </div>
                            <div class="clearfix signupFooter">
                                <button type="submit" class="btn btn-primary pull-right" id="btnRegister">Join Us</button>
                            </div>
                          </form>
                      </div>
                      <div class="tab-pane" id="tab_2">
                          <form action="" method="post" id="formCompany">
                            <div class="row">
                              <div class="col-xs-3">
                                <label>Company</label>
                              </div>
                              <div class="col-xs-9">
                                <input class="form-control" name="name" id="inputCompanyName" type="text" placeholder="company name" required="">
                              </div>
                            </div>
                            <div class="row">
                              <div class="col-xs-3">
                                <label>Email</label>
                              </div>
                              <div class="col-xs-9">
                                <input class="form-control" name="email" id="inputCompanyEmail" type="email" placeholder="Email" required="">
                              </div>
                            </div>
                            <div class="row">
                              <div class="col-xs-3">
                                <label>Password</label>
                              </div>
                              <div class="col-xs-9">
                                <input class="form-control" name="password" id="inputCompanyPassword" type="password" placeholder="Password" required="">
                              </div>
                            </div>
                            <div class="clearfix signupFooter">
                                <button type="submit" class="btn btn-primary pull-right" id="btnCompanyRegister">Build</button>
                            </div>
                          </form> 
                      </div>
                  </div>
              </div>
            </div>
            <div class="col-md-8">
              <div class="promoteContainer pull-right">
                <img src="/public/imgs/promote.jpg" style="width:100%">
              </div>
            </div>
          </div>
        </div>
        <footer class="clearfix pageFooter">
          <p class="pull-right text-center">© Found by Joeylin</p>
        </footer>
        <script type="text/javascript" src="/public/js/lib/jquery-1.9.1.min.js"></script>
        <script type="text/javascript" src="/public/js/lib/icheck.min.js"></script>
        <script type="text/javascript" src="/public/js/lib/bootstrap.min.js"></script>
        <script type="text/javascript" src="/public/js/lib/jquery-validate.js"></script>
        
        <script type="text/javascript">
            $('#formUser').validate({
                onkeyup: false,
                rules: {
                    email: {
                        required: true,
                        email: true
                    },
                    password: {
                        required: true,
                        minlength: 5
                    }
                },
                submitHandler:function(form) {
                    var data = {
                        name: $('#inputName').val(),
                        email: $('#inputEmail').val(),
                        password: $('#inputPassword').val(),
                        sex: $('#userSex').prop('checked')? 'Male':'Female',
                        role: 'user'
                    };
                    var errorHtml = '<label class="error" id="customError"></label>';
                    $.ajax({
                        url: "/api/user/register",
                        type: "post",
                        data: data,
                        success: function (data) {
                            if (data.code === 200) {
                                $('#btnRegister').attr("disabled","disabled");
                                $('#btnRegister').text("Sign Up");
                                window.location.href = '/register/step1';
                            }
                            else {
                                $('#btnRegister').text("Sign Up");
                                $(errorHtml).text(data.info).appendTo('.signupFooter');
                            }
                        },
                        error: function (e) {
                            $('#btnRegister').text("Sign Up");
                            $(errorHtml).text(data.info).appendTo('.signupFooter');
                        }
                    });
                    return false;
                }
            });
            $('#formCompany').validate({
                onkeyup: false,
                rules: {
                    email: {
                        required: true,
                        email: true
                    },
                    password: {
                        required: true,
                        minlength: 5
                    }
                },
                submitHandler:function(form) {
                    var data = {
                        name: $('#inputCompanyName').val(),
                        email: $('#inputCompanyEmail').val(),
                        password: $('#inputCompanyPassword').val(),
                        role: 'company'
                    };
                    var errorHtml = '<label class="error" id="customError"></label>';
                    $.ajax({
                        url: "/api/user/register",
                        type: "post",
                        data: data,
                        success: function (data) {
                            if (data.code === 200) {
                                $('#btnCompanyRegister').attr("disabled","disabled");
                                window.location.href = '/settings/profile';
                            }
                            else {
                                $(errorHtml).text(data.info).appendTo('.signupFooter');
                            }
                        },
                        error: function (e) {
                            $(errorHtml).text(data.info).appendTo('.signupFooter');
                        }
                    });
                    return false;
                }
            }); 
            $('#inputCompanyEmail').add('#inputCompanyName').on('keydown', function() {
                $('#customError').remove();
            });
            $('#inputEmail').add('#inputName').on('keydown', function() {
                $('#customError').remove();
            });
            $(".inputRadio").iCheck({
                radioClass: 'iradio_minimal'
            });
            var redirectTo = window.location.search.replace('?', '').split('=')[1];
            $('#btnLogin').on('click', function(e) {
              var email = $('#loginEmail').val();
              var password = $('#loginPassword').val();
              if (email === '') {
                $('#loginEmail').addClass('error');
                $('#loginEmail').focus();
                return false;
              }
              if (password === '') {
                $('#loginPassword').addClass('error');
                $('#loginPassword').focus();
                return false;
              }
              var data = {
                email: email,
                password: password
              };
              $.ajax({
                  url: "/api/user/login",
                  type: "post",
                  data: data,
                  success: function (data) {
                      if (data.code === 200) {
                          if (data.stage < 3) {
                            window.location.href = '/register/step' + data.stage;
                          }
                          if (redirectTo) {
                            window.location.href = redirectTo;
                          } else {
                            window.location.href = '/home';
                          }
                      } else {
                          $('#loginEmail').addClass('error');
                          $('#loginEmail').focus();
                      }
                  },
                  error: function (e) {
                      $('#loginEmail').addClass('error');
                      $('#loginEmail').focus();
                  }
              });
            });
            $('#loginEmail').add('#loginPassword').on('blur', function() {
              $(this).removeClass('error');
            });
            $('#loginPassword').on('keydown', function(e) {
              var key = e.keyCode || e.which;
              if (key === 13) {
                  $('#btnLogin').click();
              }
            });
        </script>
    </body>
</html>