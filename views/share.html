<!DOCTYPE html>
<html lang="en">
    <head>
        <meta http-equiv="content-type" content="text/html; charset=UTF-8"> 
        <title>MPush</title>
        <meta name="generator" content="MPush" />
        <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

        <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon"/>
        <!-- bootstrap 3.0.2 -->
        <link href="/public/css/bootstrap.min.css" rel="stylesheet" type="text/css" />
        <!-- font Awesome -->
        <link href="/public/css/font-awesome.min.css" rel="stylesheet" type="text/css" />
        <!-- Theme style -->
        <link href="/public/css/AdminLTE.css" rel="stylesheet" type="text/css" />
        <link rel="stylesheet" href="/public/css/common.css">
        <!-- magnific popup style -->
        <link rel="stylesheet" href="/public/js/lib/magnific-popup/magnific-popup.css">
        <!-- atwho -->
        <link rel="stylesheet" href="/public/js/lib/atwho/jquery.atwho.css">
        <!-- flexText -->
        <link rel="stylesheet" href="/public/js/lib/flexText/jquery.flexText.css">

        <!--[if lt IE 9]>
          <script src="//html5shim.googlecode.com/svn/trunk/html5.js"></script>
        <![endif]-->

        <!-- CSS code from MPush.com editor -->
        
        <style type="text/css">
            /*
           * Style tweaks
           * --------------------------------------------------
           */
          body {
            font-family: 'Helvetica Neue', 微软雅黑, Tohoma;
            background: url("/public/imgs/bg.png") 0 0 repeat;
          }
          .profile-body {
            min-height: 940px;
          }
          .navbar {
            border-radius: 0px;
          }
          footer {
            padding-left: 15px;
            padding-right: 15px;
            background-color: #fff;
          }
          .container {
            max-width: 970px;
          }
          .section {
            margin-bottom: 20px;
          }
          .well .section {
            margin-bottom: 0;
          }
          .jumbotron {
            padding-bottom: 33px;
            padding-top: 38px;
            padding-left: 50px;
            padding-right: 50px;
          }
          .container .jumbotron {
            border-radius: 0;
          }
          .jumbotron .btn {
            width: 74px;
          }
          .jumbotron h1 {
            font-size: 36px;
            margin-top: 0;
          }
          .user-detail .col-md-3 {
            text-indent: -15px;
          }
          .well h3 {
            margin-top: 10px;
          }
          .well h4 {
            margin-top: 2px;
          }
          .company-about .btn {
            margin-top: 10px;
            margin-bottom: 0;
          }
          .style-flat h5 {
            font-weight: 700;
            margin-bottom: 0px;
          }
          .media-info .date {
            color: #99a1a6;
            font-size: 0.9em;
          }
          .media-info .media-controll {
            padding-right: 16px;
          }
          .pager li>a {
            border-radius: 3px;
          }
          .news .panel-heading {
            border-bottom: 1px solid #ddd;
          }
          .news .panel-title {
            font-weight: 700;
            font-size: 18px;
          }
          .media-heading a {
            color: rgb(51, 51, 51);
          }
          .media-heading a:hover {
            color: #3c8dbc;
          }
          .media-info .media-control .like {
            margin-right: 5px;
          }
          .media-info .media-control .liked {
            color: rgb(51, 51, 51);
          }
          .reply-panel {
            position: relative;
          }
          .reply-panel:after {
            bottom: 100%;
            right: 30px;
            border: solid transparent;
            content: " ";
            height: 0;
            width: 0;
            position: absolute;
            pointer-events: none;
            border-color: rgba(255, 255, 255, 0);
            border-bottom-color: #ffffff;
            border-width: 10px;
            margin-left: -10px;
          }
          .comment-editor.comment-editor-inline {
            margin-top: 9px;
            padding: 10px 20px;
            background-color: #ddd;
          }
          .comment-editor .input-group-btn {
            vertical-align: bottom;
          }
          .comment-editor .input-group-btn:last-child>.btn {
            margin-left: 8px;
          }
          .view-sidebar .user-basic {
            margin-left: 100px;
          }
          .view-sidebar .user-basic h3 {
            margin-top: 0;
          }
          .view-sidebar .well .user-signature {
            margin-top: 15px;
          }
          .view-sidebar .find-btn  {
            border: 1px solid #ddd;
            background-color: #fff;
            margin-bottom: 0;
            font-weight: 400;
            text-align: center;
            cursor: pointer;
            vertical-align: middle;
            white-space: nowrap;
            padding: 6px 12px;
            font-size: 14px;
            line-height: 1.42857143;
            border-radius: 3px;
          }
          .media-info {
            margin-top: 15px;
          }
          .post {
            padding: 3px 10px;
            display: inline-block;
            background-color: #0d9572;
            color: #fff;
          }
          .post.btn:hover {
            color: #fff;
            background-color: #00694e;
          }
          .container .well {
            
          }
          .container .well h3 {
            margin-top: 0;
          }
          .reply-container {
            padding: 30px;
          }
          .comment-editor .input-group-btn > .btn {
            border-bottom-left-radius: 3px;
            border-top-left-radius: 3px;
          }
          .notifications-menu .dropdown-menu {
            width: 130px!important;
          }
          .no-notify {
            padding: 15px;
          }

          .forkContent {
            background-color: #ddd;
            padding: 15px;
            margin-bottom: 15px;
            border-radius: 4px;
          }
          .well > .title {
            font-weight: 700;
            margin-bottom: 15px;
          }
          .at {
            color: #428bca;
          }
          .fork-popup .mfp-container:before {
            content: '';
            display: inline-block;
            height: 20%;
            vertical-align: middle;
          }
          .fork-popup .flex-text-wrap > pre {
            min-height: 74px;
          }

          .well {
            -webkit-box-shadow: none;
            box-shadow: none;
          }
          .comment-editor {
            position: relative;
          }
          .comment-editor-inline .input-group-btn {
            top: -1px;
          }
          .comment-editor-inline.comment-editor .flex-text-wrap > pre {
            min-height: 20px;
          }
          .comment-editor .flex-text-wrap > pre {
            min-height: 74px;
            margin-bottom: 0;
            padding: 6px 12px;
            line-height: 1.42857143;
          }
          .comment-editor .flex-text-wrap textarea {
            position: absolute;
            height: 100%;
            width: 100%;
          }

          
          /* footer */
          footer {
            border-top: 1px solid #E0E0E0;
            padding: 10px 0;
            text-align: left;
            background: #f9f9f9;
            color: #999;
          }
        </style>
        <!-- for angular ng-cloak -->
        <style type="text/css">@charset "UTF-8";[ng\:cloak],[ng-cloak],[data-ng-cloak],[x-ng-cloak],.ng-cloak,.x-ng-cloak,.ng-hide{display:none !important;}ng\:form{display:block;}.ng-animate-start{clip:rect(0,auto,auto,0);-ms-zoom:1.0001;}.ng-animate-active{clip:rect(-1px,auto,auto,0);-ms-zoom:1;}
        </style>
        <script src="/public/bower_components/reserveLoadjs/reserveLoad.js"></script>
        <script type="text/javascript">
          window.author = null;
          window.shareObj = null;
          <% if (locals.share) { %>
            window.shareObj = <%- JSON.stringify(locals.share) %>;
          <% } %>
          <% if (locals.author) { %>
            window.author = <%- JSON.stringify(locals.author) %>;
          <% } %>
        </script>          
    </head>
    
    <!-- HTML code from Bootply.com editor -->  
    <body>
        <nav class="navbar navbar-inverse" role="navigation">
          <div class="container">
            <div class="navbar-header">
              <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
              </button>
              <a class="navbar-brand" href="#">多推</a>
            </div>
            <div class="navbar-collapse collapse">
              <ul class="nav navbar-nav navbar-right" ng-cloak>
                  <% if (!locals.author) { %>
                  <li class="dropdown" id="menuLogin" >
                      <a class="dropdown-toggle" href="/login?re=/profile/<%= locals.share.user.id %>" target="_self">登录</a>
                  </li>
                  <% } else { %>
                  <li class="dropdown notifications-menu user-menu" id="menuNotify">
                      <a href="#" class="dropdown-toggle" data-toggle="dropdown" >
                            <i class="fa fa-bell"></i> 
                            <span class="label label-wraning">{{request.connect + request.group}}</span>
                        </a>
                        <ul class="dropdown-menu" class="request-container">
                            <li ng-show="request.connect"><a href="/request/connect" target="_self">{{request.connect}} 个好友请求</a></li>
                            <li ng-show="request.group"><a href="/request/group" target="_self">{{request.group}} 个圈消息</a></li>

                            <li><a href="/request/comment" target="_self">查看评论</a></li>
                            <li><a href="/request/at" target="_self">查看@我</a></li>
                        </ul>
                  </li>
                  <li class="dropdown user user-menu">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">
                            <img src="<%= locals.author && locals.author.avatar %>" alt="" class="nav-user-pic img-responsive">             
                            <span id="lblUsername" style="margin-left: 5px;">
                              <%= locals.author && locals.author.name %>
                            </span>
                            <b class="caret"></b>
                        </a>
                        <ul class="dropdown-menu">
                            <!-- User image -->
                            <li class="user-header bg-modena">
                                <img src="<%= locals.author && locals.author.avatar %>" class="img-circle" alt="User Image" class="user_avatar">
                                <p>
                                    <span class="user_username"> <%= locals.author &&locals.author.name %></span>
                                </p>
                            </li>
                            <!-- Menu Body -->
                            <li class="user-body">
                                <div class="col-xs-6 text-center">
                                    <a href="#" ><%= locals.author.share.length %></a>
                                </div>
                                <div class="col-xs-6 text-center">
                                    <a href="#"><%= locals.author.connects.length %></a>
                                </div>
                                <div class="col-xs-6 text-center">
                                    <a href="#">share</a>
                                </div>
                                <div class="col-xs-6 text-center">
                                    <a href="#">Connects</a>
                                </div>
                            </li>
                            <!-- Menu Footer-->
                            <li class="user-footer">
                                <div class="pull-left">
                                    <a href="/settings/account" target="_self" class="btn btn-default btn-flat">账户</a>
                                </div>
                                <div class="pull-right">
                                    <a href="#" class="btn btn-default btn-flat" id="btnLogout">退出</a>
                                </div>
                            </li>
                        </ul>
                  </li>
                  <% } %>
              </ul>
              <ul class="nav navbar-nav navbar-left">
                <li><a href="/home" target="_self">首页</a></li>
                <li><a href="/profile" target="_self">个人主页</a></li>
                <li><a href="/group" target="_self">圈子</a></li>
              </ul>
            </div> 
          </div>
        </nav>
        <div class="container">
          <div class="profile-body col-md-9" ng-controller="indexCtrl">
            <div class="well" ng-cloak>
              <div class="title" ng-if="share.group">来自 <a href="/group/{{share.group.id}}" target="_self" style="color:#333;"> {{share.group.name}}</a> 兴趣圈 <a href="/profile/{{share.user.id}}" target="_self">{{ '@' + share.user.name}} :</a></div>
              <div class="title" ng-if="!share.group"><a href="/profile/{{share.user.id}}" target="_self">{{ '@' + share.user.name}} :</a></div>
              <p md-content="share.content"></p>
              <div class="forkContent" ng-if="share.isFork">
                <p ng-if="share.from.group"><a href="/profile/{{share.from.user.id}}" target="_self">{{'@' + share.from.user.name}}</a> 发布于 <a href="/group/{{share.from.group.id}}" target="_self">{{share.from.group.name}}</a></p>
                <p ng-if="!share.from.group"><a href="/profile/{{share.from.user.id}}" target="_self">{{'@' + share.from.user.name}}</a></p>
                <p md-content="share.from.share.content"></p>
                <div class="date" style="color:#99a1a6;font-size:0.9em;">{{share.from.share.createAt | formatDate:true}}</div>
              </div>
              <% if (locals.author) { %>
              <div class="clearfix media-info" ng-cloak>
                <span class="pull-left media-control">
                  <a href="#" class="date" style="margin-right:15px;">{{share.createAt | formatDate:true}}</a>
                  <a href="" class="like" ng-class="{liked:share.liked}" ng-click="toggleLike()"><i class="fa fa-fw fa-thumbs-o-up"></i>({{share.likes}})</a>

                  <span class="collect" ng-click="toggleCollect()" style="margin-right:5px;">
                    <a href="" ng-show="!share.has_collect">收藏</a>
                    <a href="" ng-show="share.has_collect">已收藏</a>
                  </span>
                  <span class="toMyFriends"><a href="" ng-click="forkPopup()">分享({{share.fork}})</a></span>

                </span>
                <a href="" class="comment pull-right" style="line-height:28px;"><i class="fa fa-fw fa-comments"></i>({{share.total}})</a>
              </div>
              <% } else { %> 
              <div class="clearfix media-info" ng-cloak>
                <span class="pull-left media-control">
                  <a href="#" class="date" style="margin-right:15px;">{{share.createAt | formatDate:true}}</a>
                  <span class="like"><i class="fa fa-fw fa-thumbs-o-up"></i>({{share.likes}})</span>
                  <span class="toMyFriends"><span>分享({{share.fork}})</span></span>
                </span>
                <a href="" class="comment pull-right" style="line-height:28px;"><i class="fa fa-fw fa-comments"></i>({{share.total}})</a>
              </div>
              <% } %>       
            </div>
            <div class="panel reply-panel" ng-cloak>
              <div class="panel-body reply-container">
                <div class="input-group comment-editor">
                    <textarea auto-cut auto-height class="form-control" rows="3" placeholder="您有什么看法呢..." ng-model="share.newComment"></textarea>
                    <span class="input-group-btn">
                        <% if (locals.author) { %>
                        <button class="btn btn-primary reply-submit btn-sm" type="button" ng-click="submitComment()">评论</button>
                        <% } else { %>
                        <a class="btn btn-primary reply-submit checkLogin btn-sm" href="#login-popup" type="button">评论</a>
                        <% } %>
                    </span>
                </div>
                <hr>
                <div class="media reply-item" ng-repeat-start="comment in share.comments">
                  <a class="pull-left" ng-href="/profile/{{comment.user.id}}" target="_self">
                    <img class="media-object" alt="34x34" ng-src="{{comment.user.avatar}}" style="width: 34px; height: 34px;">
                  </a>
                  <div class="media-body">
                    <p class="reply-content"><span class="reply-user"><a ng-href="/profile/{{comment.user.id}}" target="_self">{{comment.user.name}}</a>: </span>{{comment.content}}</p>
                    <div class="clearfix media-info">
                      <span class="date pull-left">{{comment.date | formatDate:true}}</span>
                      <span class="pull-right media-control">
                        <% if (locals.author) { %>
                        <a href="#" class="comment" ng-click="delete(comment)" ng-show="isMyShare || comment.user._id === global.author._id"><i class="fa fa-fw fa-trash-o"></i></a>
                        <a href="#" class="comment" ng-click="reply(comment)">回复</a>
                        <% } %>
                      </span>
                    </div>
                    <div class="input-group comment-editor comment-editor-inline" ng-show="comment.isShowReply">
                        <textarea auto-height auto-cut class="form-control" rows="1" placeholder="输入评论" ng-model="comment.newComment"></textarea>
                        <span class="input-group-btn">
                            <button class="btn btn-primary btn-sm" type="button" ng-click="submitInlineComment(comment)">评论</button>
                        </span>
                    </div>
                  </div>
                </div>
                <hr ng-repeat-end ng-show="!$last">
                <div ng-show="share.comments.length === 0" class="text-center">
                  还没有人发表回复哦，快来回复一下吧。
                </div>
                <hr ng-show="share.comments.length > 0 && share.pager">
                <div ng-show="share.comments.length > 0 && share.pager">
                  <ul class="pager" style="font-size:12px;">
                    <li ng-class="{'disabled': pager.current === 1}" ng-click="prev()"><a href="#">上一页</a></li>
                    <li ng-class="{'disabled': !pager.hasNext}" ng-click="next()"><a href="#">下一页</a></li>
                  </ul>
                </div>
              </div>
            </div>
          </div>
          <div class="profile-sidebar col-md-3 view-sidebar">
            <div class="well" ng-cloak>
              <div class="media">
                  <a class="pull-left" target="_self" href="/profile/<%= locals.share.user.id %>">
                      <img class="media-object" alt="64x64" src="<%= locals.share.user.avatar %>"  style="width: 74px; height: 74px;" >
                  </a>
                  <div class="media-body">
                      <h4><%= locals.share.user.name %></h4>
                      <div>微说: <%= locals.share.user.share %></div>
                      <div>人脉: <%= locals.share.user.connects %></div>
                  </div>
              </div>
              <!-- Menu Body -->
              <div class="user-signature clearfix">
                  <i class="fa fa-fw fa-quote-left" style="font-size:11px;"></i>
                  <span><%= locals.share.user.signature || '作者还没填写呢' %></span>
                  <i class="fa fa-fw fa-quote-right" style="font-size:11px;"></i>
              </div>
            </div>
            <div class="panel panel-default section">
              <div class="panel-heading">相关微说</div>
              <div class="panel-body">
                暂时还没有呢
              </div>
            </div>
            <div class="panel panel-default section">
              <div class="panel-heading">推荐职位</div>
              <div class="panel-body">
                暂时还没有呢
              </div>
            </div>
          </div>     
        </div>
        <footer class="text-center">
          <p class="">© by Joeylin 331547274@qq.com <a href="/about/feedback" target="_blank">意见与反馈</a></p>
        </footer>
        <div id="login-popup" class="white-popup-block mfp-hide">
          你还没有登录哦!
        </div>
        <div class="mfp-bg mfp-ready" ng-cloak ng-if="global.fork.open"></div>
        <div class="mfp-wrap mfp-close-btn-in mfp-ready fork-popup" style="overflow-y: auto; overflow-x: hidden;" ng-cloak ng-if="global.fork.open">
          <div class="mfp-container mfp-s-ready mfp-inline-holder">
            <div class="mfp-content">
              <div class="white-popup-block" style="width:560px;max-width:560px;">
                <label style="margin-bottom:10px;">分享到我的好友圈 : </label>
                <div class="forkContent" style="background-color:#ddd;">
                  <p ng-if="global.fork.groupName"><a href="/profile/{{global.fork.userId}}" target="_self">{{'@' + global.fork.userName}}</a> 发布于 <a href="/group/{{global.fork.groupId}}" target="_self">{{global.fork.groupName}}</a></p>
                  <p ng-if="!global.fork.groupName"><a href="/profile/{{global.fork.userId}}" target="_self">{{'@' + global.fork.userName}}</a></p>
                  <p md-content="global.fork.content"></p>
                  <div class="date" style="color:#99a1a6;font-size:0.9em;">{{global.fork.date | formatDate:true}}</div>
                </div>
                <div class="form-group newTopic">
                    <textarea auto-height atwho="global.fork.userList" class="form-control" ng-model="global.fork.forkShare" ng-change="global.fork.change(global.fork.forkShare)" id="forkText"></textarea>
                </div>
                <div class="clearfix">
                  <span class="pull-left" ng-show="global.fork.shareCount <= 140">你还可以输入<span class="shareCount">{{140 - global.fork.shareCount}}</span> 字</span>
                  <span class="pull-left" ng-show="global.fork.shareCount > 140">你已经超过<span class="global.shareCount" style="color:#E44443;">{{global.fork.shareCount - 140}}</span> 字</span>
                  <a class="btn btn-primary pull-right" role="button" ng-click="global.fork.submit()" ng-class="{'default': global.fork.forkShare === '' || (global.fork.shareCount > 140)}" style="padding-left:20px; padding-right:20px;">分享</a>
                </div>
                <button title="Close" type="button" class="mfp-close" ng-click="global.fork.close()">×</button>
              </div>
            </div>
          </div>
        </div>
        <script>
          reserveLoad(
            '/public/bower_components/jquery/jquery.js',
            '/public/bower_components/angular/angular.js',
            '/public/bower_components/angular-animate/angular-animate.js',
            '/public/bower_components/angular-cookies/angular-cookies.js',
            '/public/bower_components/angular-resource/angular-resource.js',
            '/public/bower_components/google-code-prettify/src/prettify.js',
            '/public/bower_components/angular-route/angular-route.js',
            '/public/bower_components/marked/lib/marked.js',
            '/public/bower_components/toastr/toastr.js',
            '/public/js/lib/angular-locale_zh-cn.js',
            '/public/js/lib/angular-ui.js',
            '/public/js/lib/bootstrap.min.js',
            '/public/js/lib/hmac-sha256.js',
            '/public/js/lib/sanitize.js',
            '/public/js/lib/store.js',
            '/public/js/lib/utf8.js',
            '/public/js/lib/atwho/jquery.caret.min.js',
            '/public/js/lib/atwho/jquery.atwho.js',
            '/public/js/lib/flexText/jquery.flexText.min.js',
            '/public/js/lib/magnific-popup/jquery.magnific-popup.js',
            '/public/js/bootply.js',
            '/public/js/locale_zh-cn.js',
            '/public/js/tools.js',
            '/public/js/share/router.js',
            '/public/js/services.js',
            '/public/js/filters.js',
            '/public/js/directives.js',
            '/public/js/share/controllers.js',
            '/public/js/share/app.js',
            function (errorUrl) {
              if (errorUrl) {
                alert('Error loading: ' + errorUrl);
              } else {
                angular.bootstrap(document, ['jsGen']);
              }
              $('.checkLogin').magnificPopup({
                type: 'inline',
                midClick: true
              });
              $('#btnLogout').click(function() {
                  $.ajax({
                      url: "/api/user/logout",
                      type: "post",
                      success: function(data) {
                          if (data.code === 200) {
                              window.location.reload();
                          }
                      }
                  });
              });
            }
          );
        </script>
    </body>
</html>